### **Название задачи:** Концептуальная архитектура открытия депозитов для MVP

### **Автор:** Диас

### **Дата:** 22.02.2025

---

## **Функциональные требования**

| **№** | **Действующие лица или системы** | **Use Case** | **Описание** |
| :-: | :- | :- | :- |
| 1 | Клиент | Просмотр доступных депозитов | Клиент может видеть список депозитов и актуальные ставки в интернет-банке и на сайте. |
| 2 | Клиент | Оставление заявки на депозит | Новый клиент оставляет номер телефона и Ф.И.О. на сайте. Зарегистрированный клиент заполняет заявку в интернет-банке, указывая счёт и сумму депозита. |
| 3 | Кол-центр | Обработка заявки | Кол-центр обрабатывает заявку нового клиента и предлагает особые условия. |
| 4 | Бэк-офис | Подтверждение депозита | Бэк-офис проверяет данные, подтверждает ставку и создаёт депозит в АБС. |
| 5 | Система уведомлений | Отправка СМС | Клиент получает СМС с подтверждением условий депозита. |
| 6 | Клиент | Подписание документов | Клиент подтверждает открытие депозита в интернет-банке или отделении. |

---

## **Нефункциональные требования**

| **№** | **Требование**                                                        |
| :-: |:----------------------------------------------------------------------|
| 1 | Все данные клиентов должны передаваться по зашифрованным каналам.     |
| 2 | Высокая доступность системы (99,9%).                                  |
| 3 | Время ответа на критические операции < 500 мс.                        |
| 4 | Масштабируемость интернет-банка (горизонтальная), АБС (вертикальная). |
| 5 | Использование postgres/Oracle в качестве баз данных.                  |
| 6 | Максимальное повторное использование существующих технологий.         |
| 7 | Возможность расширения системы в будущем.                             |

---

## **Решение**

### **Диаграмма**
Клиент может подавать заявку онлайн или обслуживаться у менеджера.

Промежуточный слой, который принимает заявки называем Интернет-Банк. Данный слой коммуницирует с клиентом экранами, отправляет данные в АБС для учетных расчетов и собирает данные для кол-центра.

**Выбор технологий:**
- Используем текущие базы данных (postgres, Oracle) для хранения ставок и депозитов.
- Для обмена сообщениями между системами предпочтительно использовать Kafka (но нужно решить проблему несовместимости с текущей версией интернет-банка).
- Подключение интернет-банка к АБС через промежуточный кэш (Redis) для снятия нагрузки.
- Использование API Gateway для единой точки входа клиентских запросов.
- Размещение интернет-банка на отказоустойчивом кластере с балансировкой нагрузки.

---

## **Альтернативы**

1. **Прямое взаимодействие интернет-банка с АБС**
    - (+) Упрощает архитектуру
    - (-) Высокая нагрузка на АБС, низкая доступность

2. **Использование промежуточного слоя (кэша)**
    - (+) Снижает нагрузку на АБС
    - (-) Требует дополнительного механизма обновления данных

3. **Рефакторинг интернет-банка в микросервисную архитектуру**
    - (+) Улучшает масштабируемость
    - (-) Долгосрочная стратегия, выходит за рамки MVP

---

## **Недостатки, ограничения, риски**

- Ограниченные ресурсы АБС требуют осторожного подхода к интеграции.
- Текущая несовместимость Kafka с интернет-банком ограничивает его использование.
- Возможные задержки при обработке ставок, если оставить расчёт в Excel.
- Без резервного механизма система может стать недоступной в случае сбоя основного ЦОД.

---

